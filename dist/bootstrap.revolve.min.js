/* ========================================================================
 *  bootstrap-revolve.js v0.0.1
 *  Image rotator for Bootstrap CSS Framework.
 *  https://www.github.com/matejsvajger/bootstrap-revolve
 * ========================================================================
 *  Made by Matej Svajger. Licensed under MIT:
 *  (https://github.com/matejsvajger/bootstrap-revolve/blob/master/LICENSE)
 * ======================================================================== */


!function(a,b,c,d){"use strict";function e(b,c){return this.each(function(){var d=a(this),e=d.data("bs.revolve"),g=a.extend({},f.DEFAULTS,d.data(),"object"==typeof b&&b);e||d.data("bs.revolve",e=new f(this,g)),"string"==typeof b?e[b](c):e.show(c)})}var f=function(b,d){this.options=d,this.$body=a(c.body),this.$element=a(b),this.$modal=a(d.template),this.image=a(b).attr("href"),this.images=[],this.frames=[],this.loaded=0,this.rotation=0,this.startPosition=0,this.startRotation=0,0==a("#revolve-modal").length&&a("body").append(this.$modal),this.$modal.find(".modal-body").css("cursor","ew-resize").css("position","relative").bind("mousedown touchstart",a.proxy(this.mouseDownHandler,this)),a(c).bind("mouseup touchend",a.proxy(this.mouseUpHandler,this))};f.VERSION="0.0.1",f.DEFAULTS={frames:24,addicon:!0,icon:'<div><small>360Â° <span class="glyphicon glyphicon-refresh" aria-hidden="true"></span></small></div>',template:['<div id="revolve-modal" class="modal fade" tabindex="-1" role="dialog">','<div class="modal-dialog" role="document">','<div class="modal-content">','<div class="modal-body text-center">',"</div>","</div>","</div>","</div>"].join("")},f.prototype.init=function(a){for(var b=this.image.split("."),c=b.shift().split("-").shift(),d=b.pop(),e=1;e<=this.options.frames;)this.frames.push(c+"-"+e+"."+d),e++;this.addicon()},f.prototype.show=function(b){0==this.images.length&&this.preload();var c=a(this.options.icon).css("position","absolute").css("color","#000").css("bottom","16px").css("right","20px");a(this.$modal).find(".modal-body").html(a(this.images).first()),this.options.addicon&&a(this.$modal).find(".modal-body").append(c),a(this.$modal).modal("show")},f.prototype.preload=function(b){for(var d in this.frames){var e=c.createElement("img");a(e).one("load",a.proxy(this.loadHanlder,this)),e.ondragstart=function(){return!1},e.src=this.frames[d],e.style.width="100%",this.images.push(e)}},f.prototype.loadHanlder=function(a){this.loaded++,this.loaded==this.frames.length&&this.$element.trigger("loaded.bs.revolve")},f.prototype.addicon=function(b){if(this.options.addicon){this.$element.css("position","relative").css("display","block");var c=a(this.options.icon).css("position","absolute").css("color","#000").css("bottom","4px").css("right","8px");this.$element.append(c)}},f.prototype.mouseUpHandler=function(a){this.$modal.find(".modal-body").off("mousemove touchmove")},f.prototype.mouseDownHandler=function(b){this.startRotation=this.rotation,this.startPosition="mousedown"===b.type.toLowerCase()?b.pageX:b.originalEvent.touches[0].pageX,this.$modal.find(".modal-body").bind("mousemove touchmove",a.proxy(this.mouseMoveHandler,this))},f.prototype.mouseMoveHandler=function(a){var b="mousemove"===a.type.toLowerCase()?a.pageX:a.originalEvent.touches[0].pageX,c=this.startPosition-b,d=this.startRotation+c/2.5;this.rotation=(d%360+360)%360;var e=1+Math.round(this.rotation/360*(this.frames.length-1));e=e!=this.frames.length?e:0,this.$modal.find("img").attr("src",this.frames[e])};var g=a.fn.revolve;a.fn.revolve=e,a.fn.revolve.Constructor=f,a.fn.revolve.noConflict=function(){return a.fn.revolve=g,this},a(c).on("click.bs.revolve.data-api",'[data-toggle="revolve"]',function(b){var c=a(this),d=c.data("bs.revolve")?"show":c.data();c.is("a")&&b.preventDefault(),e.call(c,d,this)}),a(function(){a('[data-toggle="revolve"]').each(function(){var b=a(this);e.call(b,"init",this)})})}(jQuery,window,document);